<!DOCTYPE html>
<html>
<head>
  <title>Custom NetCDF Viewer</title>
  <meta charset="utf-8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.5.1/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-timedimension@1.1.1/dist/leaflet.timedimension.control.min.css" />  
    <style>
    #map { height: 100vh; }
  </style>
</head>
<body>

<div id="map"></div>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/leaflet@1.5.1/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.8.0/proj4.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/proj4leaflet/1.0.2/proj4leaflet.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/iso8601-js-period@0.2.1/iso8601.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/leaflet-timedimension@1.1.1/dist/leaflet.timedimension.min.js"></script>
<script>
  // Define your custom CRS (based on HRRR-style Lambert Conformal Conic)
  var crs = new L.Proj.CRS('EPSG:9122',
  '+proj=lcc +lat_1=38.5 +lat_2=38.5 +lat_0=38.5 +lon_0=-97.5 +x_0=0 +y_0=0 +a=6371229 +b=6371229 +units=m +no_defs',
  {
    resolutions: [
      8192, 4096, 2048, 1024, 512, 256, 128, 64, 32, 16, 8, 4, 2, 1
    ],
    origin: [0, 0] // You can leave this in; it's safe even if unused
  }

);

  var map = L.map('map', {
  center: [38.5, -97.5],
  zoom: 4,
  timeDimension: true,
  timeDimensionControl: true
});

// Add OpenStreetMap base layer
var baseLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'
});
baseLayer.addTo(map);

  
  // Add WMS Time-enabled Layer from GeoServer
  var wmsLayer = L.tileLayer.wms("http://192.168.56.31:8081/geoserver/ows?", {
    layers: "ne:hrrr_apcp",
    format: 'image/png',
    transparent: true,
    version: '1.3.0',
    styles: '',
    crs: L.CRS.EPSG3857,
  // ask GeoServer to reproject on the fly:
    srs: 'EPSG:3857',
    time: ''
  });

  var timeLayer = L.timeDimension.layer.wms(wmsLayer, {
    updateTimeDimension: true,
    requestTimeFromCapabilities: true
  });

  timeLayer.addTo(map);
</script>

</body>
</html>

